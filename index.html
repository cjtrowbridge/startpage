<!DOCTYPE html>
<html lang="en">
<head>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="icon" type="image/jpg" href="/cj.jpg">

  <style type="text/css">
    html{
      background: url(img/background.jpg) no-repeat center center fixed;
      -webkit-background-size: cover;
      -moz-background-size: cover;
      -o-background-size: cover;
      background-size: cover;
    }
    body, .container{
      background: none;
    }
    .card{
      background-color: #101627;
    }
    body, h1, h2, h3, h4, h5, h6, a{
      color: #D3AFA6;
    }
    #localLinks{
      display: none;
    }
    .timer{
      display: none;
    }
    video, card-columns{
      max-width: 100%;
    }
  </style>

  <title>Startpage - CJ Trowbridge</title>
</head>
<body>
  <div class="container">
    <div class="col-12">
      <!--Maybe put something here-->&nbsp;
    </div>
    <div class="row">
      <div class="card-columns">
        
        <div class="card mb-4 local">
          <div class="card-body">
            <h5 class="card-title">Local Network <a href="javascript:void(0);" onclick="updateRepository();">üîÅ</a><span id="updateRepositoryTimer" class="timer">‚åõ</span></h5>
            <div class="card-text" id="cardConnectivity">
              <ul>
                <li><a id="linkInternet"     href="https://google.com">Internet</li>
                <li><a id="linkFiHotspot"    href="http://192.168.1.1">T-Mobile Hotspot</a></li>
                <li><a id="linkRouter"       href="http://192.168.0.1">Router</a></li>
                <li><a id="linkNAS"          href="http://192.168.0.2">NAS</a></li>
                <li><a id="linkServer"       href="http://192.168.0.3">Server</a></li>
                <li><a id="linkBridge"       href="http://192.168.0.4">Bridge</a></li>
                
                <li><a id="linkInside"       href="http://192.168.0.10">Inside Sensors</a></li>
                <li><a id="linkOutside"      href="http://192.168.0.11">Outside Sensors</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <!--
        <div class="card mb-4 local">
          <div class="card-body">
            <h5 class="card-title"><a href="http://192.168.0.3/youtube">Youtube Queue</a> <a href="javascript:void(0);" onclick="GetYoutubeJobs();">üîÅ</a></h5>
            <div class="card-text">
              <div id="YoutubeJobs"></div>
            </div>
          </div>
        </div>
        -->
        
        <div class="card mb-4 local">
          <div class="card-body">
            <h5 class="card-title"><a href="http://192.168.0.3:8081">Surveillance</a> <a href="javascript:void(0);" onclick="GetSurveillanceEvents();">üîÅ</a></h5>
            <div class="card-text">
              <!--a href="http://192.168.0.3:8081"><img id="motionjpeg" src="http://192.168.0.3:8081/" style="min-width: 480px; width: 100%; min-height: 320px" /></a-->
              <div id="SurveillanceEvents"></div>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->

        <div class="card mb-4 local">
          <div class="card-body">
            <h5 class="card-title">Sensor Telemetry <a href="javascript:void(0);" onclick="updateSensors();">üîÅ</a><span id="updateTelemetryTimer" class="timer">‚åõ</span></h5>
            <div class="card-text">
              <div id="sensorData"></div>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->

        <div class="card mb-4 local">
          <div class="card-body">
            <h5 class="card-title">Server Telemetry <a href="javascript:void(0);" onclick="updateServer();">üîÅ</a></h5>
            <div class="card-text">
              <div id="serverData"></div>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->


      </div><!--/card-columns-->
    </div><!--/row-->
    <div class="row">
      
      <div class="card-columns" id="internetLinks">
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Google Search</h5>
            <div class="card-text">
              <form class="form" method="get" action="https://www.google.com/search">
                <input type="text" class="form-control" name="q" size="31" value="" autofocus="autofocus" >
              </form>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Daily</h5>
            <div class="card-text">
              <ul>
                <li><a href="https://mail.protonmail.com/inbox">ProtonMail</a></li>
                <li><a href="https://calendar.google.com/calendar/r#main_7%7Cweek">Calendar</a></li>
                <li><a href="https://trello.com/b/L0z2c79k/to-do">Trello: Todo</a></li>
                <li><a href="https://cjtrowbridge.com/news">World News Audio Recap</a></li>
                <li><a href="https://newsmap-js.herokuapp.com/">Newsmap</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Waste Time</h5>
            <div class="card-text">
              <ul>
                <li><a href="https://4chan.org/">4chan</a></li>
                <li><a href="https://news.ycombinator.com/">Hacker News</a></li>
                <li><a href="https://huffpost.com/">Huffington Post</a></li>
                <li><a href="https://reddit.com">Reddit</a></li>
                <li><a href="https://facebook.com">Facebook</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Productivity</h5>
            <div class="card-text">
              <ul>
                <li><a href="https://calendar.google.com/calendar/r#main_7%7Cweek">Calendar</a></li>
                <li><a href="https://trello.com/b/L0z2c79k/to-do">Trello: Todo</a></li>
                <li><a href="https://slack.com">Slack</a></li>
                <li><a href="https://ifttt.com/">IFTTT</a></li>
                <li><a href="https://hangouts.google.com/">Hangouts</a></li>
                <li><a href="https://web.whatsapp.com/">WhatsApp</a></li>
                <li><a href="https://remotedesktop.google.com/access">Remote Desktop</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">School</h5>
            <div class="card-text">
              <h6><a href="https://inside.sfsu.edu">SFSU</a></h6>
              <ul>
                <li><a href="https://ilearn.sfsu.edu/ay2021/course/view.php?id=17939">USP 470 - City in a Global Society</a></li>
                <li><a href="https://ilearn.sfsu.edu/ay2021/course/view.php?id=15208">RRS 380 - Coloring Queer: Imagining Communities</a></li>
                <li><a href="">PHIL 621 - Minds, Brains, and Computers</a></li>
                <li><a href="https://ilearn.sfsu.edu/ay2021/course/view.php?id=13152">USP 658 - Land-Use Planning</a></li>
                <li><a href="https://ilearn.sfsu.edu/ay2021/course/view.php?id=14203">USP 530 - Alternative Urban Futures</a></li>
              </ul>
              
              <h6><a href="https://mysierra.sierracollege.edu/">My Sierra</a></h6>
              <ul>
                <li><a href="https://sierra.instructure.com/courses/342202">Fa20 ONLIN ASTR-0011 84501</a></li>
                <li><a href="https://sierra.instructure.com/courses/340472">Fa20 ONLIN PHIL-0012 85577</a></li>
              </ul>
              <h6>Tools</h6>
              <ul>
                <li><a href="https://library.sfsu.edu/urban-studies-research">Library: USP Research</a></li>
                <li><a href="https://sfsu.maps.arcgis.com/home/index.html">ARCGIS</a></li>
                <li><a href="https://csu-sfsu.userservices.exlibrisgroup.com/view/action/uresolver.do?operation=resolveService&package_service_id=5962223930002918&institutionId=2918&customerId=2900">Social Explorer</a></li>
                <li><a href="http://sfsu.qualtrics.com/">Qualtrics</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Dev</a></h5>
            <div class="card-text">
              <ul>
                <li>
                  <a href="https://github.com/">Github</a>
                  <ul>
                    <li><a href="https://github.com/cjtrowbridge/astria-14.1">Astria 14.1</a></li>
                    <li><a href="https://cjtrowbridge.com">cjtrowbridge.com</a></li>
                    <li><a href="https://github.com/cjtrowbridge/startpage">Startpage</a></li>
                  </ul>
                </li>
                <li><a href="https://vps.cjtrowbridge.com/">VPS</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Input</a></h5>
            <div class="card-text">
              <ul>
                <li><a href="https://cjtrowbridge.com/news">News</a></li>
                <li><a href="https://www.youtube.com/watch?v=5qap5aO4i9A">ChilledCow LoFi Hip Hop</a></li>
                <li><a href="https://open.spotify.com/">Spotify</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Money</h5>
            <div class="card-text">
              <ul>
                <li><a href="https://www.wellsfargo.com/">Wells Fargo</a></li>
                <li><a href="https://venmo.com/">Venmo</a></li>
                <li><a href="https://robinhood.com/">Robinhood</a></li>
                <li><a href="https://www.paypal.com/signin/">Paypal</a></li>
                <li><a href="https://bankmobilevibe.com/">Bank Mobile Vibe</a></li>
                <li><a href="https://www.mint.com/">Mint</a></li>
                <li><a href="https://stripe.com/">Stripe</a></li>
              </ul>
              <h5>Bills & Subscriptions</h5>
              <ul>
                <li><a href="https://membership.calstate.aaa.com/user/login?destination=aaa-oauth/authorize">AAA</a></li>
                <li><a href="https://www.blueshieldca.com/bsca/bsc/public/member/mp/login">Blue Cross</a></li>
                <li><a href="https://verified.capitalone.com/sic-ui/#/esignin?Product=360Bank">Capital One</a></li>
                <li><a href="https://www.costco.com/">Costco</a></li>
                <li><a href="https://www.digitalocean.com/">Digital Ocean</a></li>
                <li><a href="https://fi.google.com/account">Google Fi</a></li>
                <li><a href="https://www.privateinternetaccess.com/pages/client-sign-in">Private Internet Access</a></li>
                <li><a href="https://open.spotify.com/">Spotify</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Torrents</h5>
            <div class="card-text">
              <ul>
                <li><a href="https://audiobookbay.nl">Audiobook Bay</a></li>
                <li><a href="https://libgen.is">Library Genesis</a></li>
                <li><a href="https://thehiddenbay.org">The Hidden Bay</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">NAS</a></h5>
            <div class="card-text">
              <ul>
                <li><a href="http://192.168.86.2:5000/">CJ-NAS</a></li>
                <li><a href="http://192.168.86.2:32400/web/index.html#">Plex</a></li>
                <li><a href="http://192.168.86.2:28888/gui/">Sync</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
      
      </div><!--/card-columns-->
      
    </div><!--/col-12-->
  </div><!--/container-->


  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="js/jquery-3.4.1.min.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script>
    
    GetSurveillanceEvents();
    updateSensors();
    
    function updateSensors(){
      $('#updateTelemetryTimer').show();
      $.get("/sensors.php", function(data){
        $('#updateTelemetryTimer').hide();
        console.log("Sensor Data:");
        console.log(data);
        
        var table = "\n<table width=\"100%\">\n  <thead>\n    <tr>\n      <th><a target=\"_blank\" href=\"grapher.php\">Graphs</a></th>\n      <th>Inside</th>\n      <th>Outside</th>\n    </tr>\n  </thead>\n  <tbody>";
        
        for(var key in data['Inside']){
          if(data['Inside'].hasOwnProperty(key)){
            var sensor = key.replace("Method ", "");
            table = table + "\n    <tr>\n      <td>"+sensor+"</td>\n      <td>"+data['Inside'][key]+"</td>\n      <td>"+data['Outside'][key]+"</td>\n    </tr>";
          }
        }
        
        table = table + "\n    </tbody>\n  </table>";
        $('#sensorData').html(table);
        setTimeout(function(){updateSensors();},60000);
      });
    }
    
    function ChangeScene(scene){
      console.log('Changing Scene: '+scene); 
      $.get("api/?scene="+scene, function(data){
        console.log('Scene Changed: '+data);
      });
    }
    
    function updateRepository(){
      $('#updateRepositoryTimer').show();
      console.log('Updating...');
      $.get("api/?update", function(data){
        console.log('Updated');
        $('#updateRepositoryTimer').hide();
        location.reload();
      });
    }
    
    checkNetworkStatus();    
    function checkNetworkStatus(){
      updateServer();
      checkFiHotspot();
      checkInternet();
      checkRouter();
      checkNAS();
      checkServer();
      checkBridge();
      checkInside();
      checkOutside();
      GetSurveillanceEvents();
      GetYoutubeJobs();
      
      setTimeout(function(){checkNetworkStatus();},60000);
    }

    checkServerStatus();
    function checkServerStatus(){
      checkServer();
      setTimeout(function(){checkServerStatus();},5000);
    }
    
    function checkInternet(){
      $.get("api/?checkConnectivity=Internet", function(data){
        if(data['Internet']==true){
          $('#linkInternet').css('color','green');
        }else{
          $('#linkInternet').css('color','red');
        }
      });
    }
    function checkRouter(){
      $.get("api/?checkConnectivity=Router", function(data){
        if(data['Router']==true){
          $('#linkRouter').css('color','green');
        }else{
          console.log("Can't reach the router");
          $('#linkRouter').css('color','red');
        }
      });
    }
    function checkFiHotspot(){
      $.get("api/?checkConnectivity=FiHotspot", function(data){
        if(data['FiHotspot']==true){
          $('#linkFiHotspot').css('color','green');
        }else{
          console.log("Can't reach the Fi Hotspot");
          $('#linkFiHotspot').css('color','red');
        }
      });
    }

    function checkNAS(){
      $.get("api/?checkConnectivity=NAS", function(data){
        if(data['NAS']==true){
          $('#linkNAS').css('color','green');
        }else{
          console.log("Can't reach the NAS");
          $('#linkNAS').css('color','red');
        }
      });
    }
    function checkBridge(){
      $.get("api/?checkConnectivity=Bridge", function(data){
        if(data['Bridge']==true){
          $('#linkBridge').css('color','green');
        }else{
          console.log("Can't reach Bridge");
          $('#linkBridge').css('color','red');
        }
      });
    }
    function checkServer(){
      $.get("api/?checkConnectivity=Server", function(data){
        if(data['Server']==true){
          $('#linkServer').css('color','green');
          $('.local').show();

          //startSurveillanceRefresh();

        }else{
          $('.local').hide();
          console.log("Can't reach the server");
          $('#linkServer').css('color','red');
        }
      });
    }
    function checkInside(){
      $.get("api/?checkConnectivity=Inside", function(data){
        if(data['Inside']==true){
          $('#linkInside').css('color','green');
        }else{
          console.log("Can't reach the Inside sensors");
          $('#linkInside').css('color','red');
        }
      });
    }
    function checkOutside(){
      $.get("api/?checkConnectivity=Outside", function(data){
        if(data['Outside']==true){
          $('#linkOutside').css('color','green');
        }else{
          console.log("Can't reach the Outside sensors");
          $('#linkOutside').css('color','red');
        }
      });
    }
    
    function GetYoutubeJobs(){
      $('#YoutubeJobs').html('Loading youtube jobs...');
      $.get("/youtube/api.php", function(data){
        $('#YoutubeJobs').html('');
        console.log('Youtube Jobs');
        console.log(data);
        $.each(data, function(i, job){
          var id           = job.id;
          var title        = job.title;
          var url          = job.url;
          var status       = job.status;
          var cacheUrl     = job.cacheUrl;
          var lastupdated  = job.lastupdated;
          var eta          = job.eta;

          var color = "warning";
          if(status=='done'){
            url = cacheUrl;
            color = "success";
            eta = status;
          }
          if(status=='in-progress'){
            color = "outline-success";
          }

          $('#YoutubeJobs').append('<a class="btn btn-'+color+' mt-2 mr-2" href="'+url+'" target="_blank">'+title+'<br>('+eta+')</a> <br>');
        });
        $('#YoutubeJobs').append('<a class="btn btn-primary mt-2 mr-2" href="/youtube/" target="_blank">More</a>');
        $('#YoutubeJobs').append('<a class="btn btn-success mt-2 mr-2" href="javascript:void(0);" onclick="AddYoutubeJob();" target="_blank">New</a>');

      });
    }
    function AddYoutubeJob(){
      var url = prompt("Youtube URL?");
      if (url != null) {
        $.get("/youtube/api.php?add="+url, function(data){
          alert(data);
          GetYoutubeJobs();
        });
      }
    }

    function GetSurveillanceEvents(){
      $('#SurveillanceEvents').html('Loading recent surveillance events...');
      $.get("/api/?getSurveillanceEvents", function(data){
        $('#SurveillanceEvents').html('');
        console.log('Recent Surveillance Events');
        console.log(data);
        var first = true;
        $.each(data, function(i, event){
          var time = event.Time;
          var ago  = event.Ago;
          var link = event.Link;
          var size = event.Size;
          if(first==true){
            first=false;
            $('#SurveillanceEvents').append('<span title="'+time+'">'+ago+'</span><br><video autoplay loop style="max-width: 100%;"><source src="'+link+'"></video>');
          }
          $('#SurveillanceEvents').append('<a class="btn btn-success mt-2 mr-2" href="'+link+'" target="_blank">'+link+'</a> '+size+'mb <span title="'+time+'">'+ago+'</span><br>');
        });
        $('#SurveillanceEvents').append('<a class="btn btn-primary mt-2 mr-2" href="/surveillance/?C=M;O=D" target="_blank">More</a>');
        
      });
    }
    function updateServer(){
      $.get("/api/?device", function(data){
        $('#serverData').html('');
        console.log('Server Data');
        console.log(data);
        var table = "<table width=\"100%\">\n  <tbody>";

        for(var key in data){
          if(data.hasOwnProperty(key)){
            table = table + "\n    <tr>\n      <td>"+key+"</td>\n      <td>"+data[key]+"</td>\n    </tr>";
          }
        }

        table = table + "\n    </tbody>\n  </table><br><a class=\"btn btn-primary\" href=\"/vps/\">VPS-Home</a>";
        $('#serverData').html(table);
      });

    }
    function MJPEG(){
      var image = $("#motionjpeg"), src;
      if (!image.length) return;
      src = image.attr("src");
      if (src.indexOf("?") < 0) {
        image.attr("src", src + "?"); // must have querystring
      }
      image.on("load", function() {
        // this cause the load event to be called "recursively"
        this.src = this.src.replace(/\?[^\n]*$/, "?") +
        (new Date()).getTime(); // 'this' refers to the image
      });
    }
    
    
    //This should be last
    MJPEG();
  </script>
</body>
</html>
