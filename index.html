<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-49854332-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-49854332-1');
  </script>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="icon" type="image/jpg" href="/cj.jpg">

  <style type="text/css">
    html{
      background: url(img/background.jpg) no-repeat center center fixed;
      -webkit-background-size: cover;
      -moz-background-size: cover;
      -o-background-size: cover;
      background-size: cover;
    }
    body, .container{
      background: none;
    }
    .card{
      background-color: #101627;
    }
    body, h1, h2, h3, h4, h5, h6, a{
      color: #D3AFA6;
    }
    #localLinks{
      display: none;
    }
    .timer{
      display: none;
    }
  </style>

  <title>Startpage - CJ Trowbridge</title>
</head>
<body>
  <div class="container">
    <div class="col-12">
      <!--Maybe put something here-->&nbsp;
    </div>
    <div class="row">
      
      <div class="col-4 col-xs-12" id="localLinks">
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Local Network <a href="javascript:void(0);" onclick="updateRepository();">üîÅ</a><span id="updateRepositoryTimer" class="timer">‚åõ</span></h5>
            <div class="card-text" id="cardConnectivity">
              <ul>
                <li><a id="linkInternet"     href="https://google.com">Internet</li>
                <li><a id="linkRouter"       href="http://192.168.86.1">Router</a></li>
                <li><a id="linkNAS"          href="http://192.168.86.2">NAS</a></li>
                <li><a id="linkServer"       href="http://192.168.86.3">Server</a></li>
                <li><a id="linkKali"         href="http://192.168.86.4">Kali</a></li>
                <li><a id="linkLaptop"       href="http://192.168.86.9">Laptop</a></li>
              </ul>
              
              <h5 class="card-title">Telemetry <a href="javascript:void(0);" onclick="updateSensors();">üîÅ</a><span id="updateTelemetryTimer" class="timer">‚åõ</span></h5>
              <div class="card-text">
                <div id="sensorData"></div>
              </div><!--End Card-text-->
              
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
      
      </div>
      <div class="col-8 col-xs-12">
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title"><a href="http://192.168.86.3:8081">Surveillance</a></h5>
            <div class="card-text">
              <img id="motionjpeg" src="http://192.168.86.3:8081/" width="480" height="320" />
              <script>
                function MJPEG(){
                  var image = $("#motionjpeg"), src;
                  if (!image.length) return;
                  src = image.attr("src");
                  if (src.indexOf("?") < 0) {
                    image.attr("src", src + "?"); // must have querystring
                  }
                  image.on("load", function() {
                    // this cause the load event to be called "recursively"
                    this.src = this.src.replace(/\?[^\n]*$/, "?") +
                    (new Date()).getTime(); // 'this' refers to the image
                  });
                }
              </script>
              <div id="SurveillanceEvents">
              </div>
              <script>
                function GetSurveillanceEvents(){
                  $('#SurveillanceEvents').html('Loading recent surveillance events...');
                  $.get("/api/?getSurveillanceEvents", function(data){
                    $('#SurveillanceEvents').html('');
                    console.log('Recent Surveillance Events');
                    console.log(data);
                    $.each(data, function(i, event){
                      var time = event.Time;
                      var ago  = event.Ago;
                      var link = event.Link;
                      $('#SurveillanceEvents').append('<a class="btn btn-success mt-2 mr-2" href="'+link+'" target="_blank">'+link+'</a><span title="'+time+'">'+ago+'</span><br>');
                    });
                    $('#SurveillanceEvents').append('<a class="btn btn-primary mt-2 mr-2" href="/surveillance/" target="_blank">More</a>'');
                  });
                }
              </script>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <!--
              <ul>
                <li><a href="javascript:void(0);" onclick="ChangeScene('morning');">Good Morning</a></li>
                <li><a href="javascript:void(0);" onclick="ChangeScene('chill');">Chill</a></li>
                <li><a href="javascript:void(0);" onclick="ChangeScene('bed_time');">Bed Time</a></li>
                <li><a href="javascript:void(0);" onclick="ChangeScene('blackout');">Blackout</a></li>
              </ul>
        -->
      </div>
    
    </div>
    <div class="row">
      
      <div class="card-columns" id="internetLinks">
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Google Search</h5>
            <div class="card-text">
              <form class="form" method="get" action="https://www.google.com/search">
                <input type="text" class="form-control" name="q" size="31" value="" autofocus="autofocus" >
              </form>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Daily</h5>
            <div class="card-text">
              <ul>
                <li><a href="https://mail.protonmail.com/inbox">ProtonMail</a></li>
                <li><a href="https://calendar.google.com/calendar/r#main_7%7Cweek">Calendar</a></li>
                <li><a href="https://trello.com/b/L0z2c79k/to-do">Trello: Todo</a></li>
                <li><a href="https://cjtrowbridge.com/news">World News Audio Recap</a></li>
                <li><a href="https://newsmap-js.herokuapp.com/">Newsmap</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Waste Time</h5>
            <div class="card-text">
              <ul>
                <li><a href="https://4chan.org/">4chan</a></li>
                <li><a href="https://news.ycombinator.com/">Hacker News</a></li>
                <li><a href="https://huffpost.com/">Huffington Post</a></li>
                <li><a href="https://reddit.com">Reddit</a></li>
                <li><a href="https://facebook.com">Facebook</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Productivity</h5>
            <div class="card-text">
              <ul>
                <li><a href="https://calendar.google.com/calendar/r#main_7%7Cweek">Calendar</a></li>
                <li><a href="https://trello.com/b/L0z2c79k/to-do">Trello: Todo</a></li>
                <li><a href="https://slack.com">Slack</a></li>
                <li><a href="https://ifttt.com/">IFTTT</a></li>
                <li><a href="https://hangouts.google.com/">Hangouts</a></li>
                <li><a href="https://web.whatsapp.com/">WhatsApp</a></li>
                <li><a href="https://remotedesktop.google.com/access">Remote Desktop</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">School</h5>
            <div class="card-text">
              <h6><a href="https://inside.sfsu.edu">SFSU</a></h6>
              <ul>
                <li><a href="https://ilearn.sfsu.edu/ay2021/course/view.php?id=5732">USP 0514-01 Sustainable Development in Cities</a></li>
                <li><a href="https://ilearn.sfsu.edu/ay2021/course/view.php?id=6407">USP 0515-01 Environmental Justice: Race, Poverty, and the Environment</a></li>
                <li>
                  <a href="https://ilearn.sfsu.edu/ay2021/course/view.php?id=3235">SXS 0400-01 Variations in Human Sexuality</a>
                  <ul>
                    <li><a href="https://www-jstor-org.jpllnet.sfsu.edu/stable/10.1525/j.ctt7zw3js">Evolution's Rainbow: Diversity, Gender, and Sexuality in Nature and People</a></li>
                  </ul>
                </li>
                <li><a href="https://ilearn.sfsu.edu/ay2021/course/view.php?id=3412">USP 0493-01 Data Analysis</a></li>
                <li><a href="https://ilearn.sfsu.edu/ay2021/course/view.php?id=5674">RRS  280 - Race, Gender, & Science Fiction</a></li>
              </ul>
              
              <h6><a href="https://mysierra.sierracollege.edu/">My Sierra</a></h6>
              <ul>
                <li><a href="https://sierra.instructure.com/courses/342202">Fa20 ONLIN ASTR-0011 84501</a></li>
                <li><a href="https://sierra.instructure.com/courses/340472">Fa20 ONLIN PHIL-0012 85577</a></li>
              </ul>
              <h6>Tools</h6>
              <ul>
                <li><a href="https://library.sfsu.edu/urban-studies-research">Library: USP Research</a></li>
                <li><a href="https://sfsu.maps.arcgis.com/home/index.html">ARCGIS</a></li>
                <li><a href="https://csu-sfsu.userservices.exlibrisgroup.com/view/action/uresolver.do?operation=resolveService&package_service_id=5962223930002918&institutionId=2918&customerId=2900">Social Explorer</a></li>
                <li><a href="http://sfsu.qualtrics.com/">Qualtrics</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Dev</a></h5>
            <div class="card-text">
              <ul>
                <li>
                  <a href="https://github.com/">Github</a>
                  <ul>
                    <li><a href="https://github.com/cjtrowbridge/astria-14.1">Astria 14.1</a></li>
                    <li><a href="https://cjtrowbridge.com">cjtrowbridge.com</a></li>
                    <li><a href="https://github.com/cjtrowbridge/startpage">Startpage</a></li>
                  </ul>
                </li>
                <li><a href="https://vps.cjtrowbridge.com/">VPS</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Input</a></h5>
            <div class="card-text">
              <ul>
                <li><a href="https://cjtrowbridge.com/news">News</a></li>
                <li><a href="https://www.youtube.com/watch?v=5qap5aO4i9A">ChilledCow LoFi Hip Hop</a></li>
                <li><a href="https://open.spotify.com/">Spotify</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Money</h5>
            <div class="card-text">
              <ul>
                <li><a href="https://www.wellsfargo.com/">Wells Fargo</a></li>
                <li><a href="https://venmo.com/">Venmo</a></li>
                <li><a href="https://robinhood.com/">Robinhood</a></li>
                <li><a href="https://www.paypal.com/signin/">Paypal</a></li>
                <li><a href="https://bankmobilevibe.com/">Bank Mobile Vibe</a></li>
                <li><a href="https://www.mint.com/">Mint</a></li>
                <li><a href="https://stripe.com/">Stripe</a></li>
              </ul>
              <h5>Bills & Subscriptions</h5>
              <ul>
                <li><a href="https://membership.calstate.aaa.com/user/login?destination=aaa-oauth/authorize">AAA</a></li>
                <li><a href="https://www.blueshieldca.com/bsca/bsc/public/member/mp/login">Blue Cross</a></li>
                <li><a href="https://verified.capitalone.com/sic-ui/#/esignin?Product=360Bank">Capital One</a></li>
                <li><a href="https://www.costco.com/">Costco</a></li>
                <li><a href="https://www.digitalocean.com/">Digital Ocean</a></li>
                <li><a href="https://fi.google.com/account">Google Fi</a></li>
                <li><a href="https://www.privateinternetaccess.com/pages/client-sign-in">Private Internet Access</a></li>
                <li><a href="https://open.spotify.com/">Spotify</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Torrents</h5>
            <div class="card-text">
              <ul>
                <li><a href="https://audiobookbay.nl">Audiobook Bay</a></li>
                <li><a href="https://libgen.is">Library Genesis</a></li>
                <li><a href="https://thehiddenbay.org">The Hidden Bay</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
        
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">NAS</a></h5>
            <div class="card-text">
              <ul>
                <li><a href="http://192.168.86.2:5000/">CJ-NAS</a></li>
                <li><a href="http://192.168.86.2:32400/web/index.html#">Plex</a></li>
                <li><a href="http://192.168.86.2:28888/gui/">Sync</a></li>
              </ul>
            </div><!--End Card-text-->
          </div><!--End Card-body-->
        </div><!--End Card-->
      
      </div><!--/card-columns-->
      
    </div><!--/col-12-->
  </div><!--/container-->


  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="js/jquery-3.4.1.min.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script>
    
    GetSurveillanceEvents();
    updateSensors();
    
    function updateSensors(){
      $('#updateTelemetryTimer').show();
      $.get("/sensors.php", function(data){
        $('#updateTelemetryTimer').hide();
        console.log("Sensor Data:");
        console.log(data);
        
        var table = "\n<table width=\"100%\">\n  <thead>\n    <tr>\n      <th><a target=\"_blank\" href=\"grapher.php\">Graphs</a></th>\n      <th>Inside</th>\n      <th>Outside</th>\n    </tr>\n  </thead>\n  <tbody>";
        
        for(var key in data['Inside']){
          if(data['Inside'].hasOwnProperty(key)){
            var sensor = key.replace("Method ", "");
            table = table + "\n    <tr>\n      <td>"+sensor+"</td>\n      <td>"+data['Inside'][key]+"</td>\n      <td>"+data['Outside'][key]+"</td>\n    </tr>";
          }
        }
        
        table = table + "\n    </tbody>\n  </table>";
        $('#sensorData').html(table);
        setTimeout(function(){updateSensors();},60000);
      });
    }
    
    function ChangeScene(scene){
      console.log('Changing Scene: '+scene); 
      $.get("api/?scene="+scene, function(data){
        console.log('Scene Changed: '+data);
      });
    }
    
    function updateRepository(){
      $('#updateRepositoryTimer').show();
      console.log('Updating...');
      $.get("api/?update", function(data){
        console.log('Updated');
        $('#updateRepositoryTimer').hide();
        location.reload();
      });
    }
    
    checkNetworkStatus();    
    function checkNetworkStatus(){
      checkInternet();
      checkRouter();
      checkNAS();
      checkServer();
      checkKali();
      
      setTimeout(function(){checkNetworkStatus();},60000);
    }
    
    function checkInternet(){
      $.get("api/?checkConnectivity=Internet", function(data){
        if(data['Internet']==true){
          $('#linkInternet').css('color','green');
        }else{
          $('#linkInternet').css('color','red');
        }
      });
    }
    function checkRouter(){
      $.get("api/?checkConnectivity=Router", function(data){
        if(data['Router']==true){
          $('#linkRouter').css('color','green');
        }else{
          console.log("Can't reach the router");
          $('#linkRouter').css('color','red');
        }
      });
    }
    function checkNAS(){
      $.get("api/?checkConnectivity=NAS", function(data){
        if(data['NAS']==true){
          $('#linkNAS').css('color','green');
        }else{
          console.log("Can't reach the NAS");
          $('#linkNAS').css('color','red');
        }
      });
    }
    function checkKali(){
      $.get("api/?checkConnectivity=Kali", function(data){
        if(data['Kali']==true){
          $('#linkKali').css('color','green');
        }else{
          console.log("Can't reach Kali");
          $('#linkKali').css('color','red');
        }
      });
    }
    function checkServer(){
      $.get("api/?checkConnectivity=Server", function(data){
        if(data['Server']==true){
          $('#linkServer').css('color','green');
          $('#localLinks').show();

          //startSurveillanceRefresh();

        }else{
          $('#localLinks').hide();
          console.log("Can't reach the server");
          $('#linkServer').css('color','red');
        }
      });
    }
    function checkLaptop(){
      $.get("api/?checkConnectivity=Laptop", function(data){
        if(data['Laptop']==true){
          $('#linkLaptop').css('color','green');
        }else{
          console.log("Can't reach the Bridge");
          $('#linkLaptop').css('color','red');
        }
      });
    }
    
    $.get("api/?checkMainPower", function(data){
      percent = data['Percent'];
      state   = data['State'];
      console.log("Main Power: "+state+" "+percent+"%");
      console.log(data);
      $('#mainPowerProgress').html('<div class="progress-bar" role="progressbar" style="width: '+percent+'%;" aria-valuenow="'+percent+'" aria-valuemin="0" aria-valuemax="100">'+percent+'%</div>');
    });
    
    $.get("api/?checkBackupPower", function(data){
      percent = data['Percent'];
      state   = data['State'];
      console.log("Backup Power: "+state+" "+percent+"%");
      console.log(data);
      $('#backupPowerProgress').html('<div class="progress-bar" role="progressbar" style="width: '+percent+'%;" aria-valuenow="'+percent+'" aria-valuemin="0" aria-valuemax="100">'+percent+'%</div>');
    });
    
    $.get("api/?checkEnginePower", function(data){
      if(data['State']==false){
        $('#enginePowerStatus').html('<span style="color: red;">Offline</span>');
      }else{
        $('#enginePowerStatus').html('<span style="color: green;">Online</span>');
      }
    });
    
    $.get("api/?checkShorePower", function(data){
      if(data['State']==false){
        $('#shorePowerStatus').html('<span style="color: red;">Offline</span>');
      }else{
        $('#shorePowerStatus').html('<span style="color: green;">Online</span>');
      }
    });
    
    
    
    
    
    //This should be last
    MJPEG();
  </script>
</body>
</html>
